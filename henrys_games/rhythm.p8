pico-8 cartridge // http://www.pico-8.com
version 32
__lua__
--rhythm fighter
--by hankdetank05

function _init()

	time_signature={4,4}
	
	bpm=60
	
	beat=1
	frame=1
	
	bpm_changed=true

end

function _update60()

	if btnp(⬆️) then
		bpm+=1
		bpm_changed=true
	elseif btnp(⬇️) then
		bpm-=1
		bpm_changed=true
	end
	
	if bpm_changed then
		bps=bpm/60
		bpf=bps/60
		fpb=1/bpf
		bpm_changed=false
	end
	
	frame+=1
	if frame>fpb then
		frame=1
		beat+=1
		if beat>time_signature[1] then
			beat=1
			sfx(0)
		else
			sfx(1)
		end
	end
	
	if frame==fpb/4 then
		sfx(2)
	elseif frame==fpb/2 then
		sfx(2)
	elseif frame==(fpb*3)/4 then
		sfx(2)
	end

end

function _draw()
	cls()
	print("bpm: "..bpm,0,6,11)
	print("frame: "..frame,0,12,11)
	print("beat: "..beat,0,18,11)
	for note=1,time_signature[1] do
		if beat==note then
			spr(18,16*note,28)
			if frame<fpb/4 then
				spr(3,16*note+8,28)
			elseif frame<fpb/2 then
				spr(19,16*note+8,28)
			elseif frame<(fpb*3)/4 then
				spr(35,16*note+8,28)
			else
				spr(51,16*note+8,28)
			end
		else
			spr(17,16*note,28)
			spr(3,16*note+8,28)
		end
	end
end
__gfx__
00000000000666500000ccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000650650000c00c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000650650000c00c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000656500000c0c065065065000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000650000000c00065065065000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000666500000ccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000666650000cccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000666500000ccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000650000000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000650000000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000650000000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000650000000c0000c065065000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000650000000c0000c065065000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000666500000ccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000666650000cccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000666500000ccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000650000000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000650000000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000650000000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000650000000c0000c00c065000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000650000000c0000c00c065000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000666500000ccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000650650000c00c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000666500000ccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000c00c00c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000c00c00c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000666500000ccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000650650000c00c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000666500000ccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
010a00001c05000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010a00001805000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010500001505000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
